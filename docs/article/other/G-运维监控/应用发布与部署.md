---
title: "应用发布与部署"
shortTitle: "应用发布与部署"
description: "应用发布与部署"
icon: ""
author: 
  name: gzw
  url: 
  email: 1627121193@qq.com
isOriginal: false
date: 2023-01-06
category: 
- "运维"
tag:
- "运维"
sticky: 1
star: false
article: true
timeline: true
dir:
  text: "应用发布与部署"
  icon: ""
  collapsible: true
  index: true
  comment: true
headerDepth: 3
index: true
order: 2
copy:
  triggerWords: 100
  disableCopy: false
  disableSelection: false
feed:
  title: "应用发布与部署"
  description: "应用发布与部署"
  author:
    name: gzw
    email: 1627121193@qq.com
---









# 应用发布与部署

:::info 说明

全量发布：

1. 蓝绿发布
2. 红黑发布

增量发布：灰度发布（金丝雀发布）

:::





## 蓝绿发布

![蓝绿发布](https://my-photos-1.oss-cn-hangzhou.aliyuncs.com/markdown//%E8%BF%90%E7%BB%B4/20230725/%E8%93%9D%E7%BB%BF%E5%8F%91%E5%B8%83.png)

发布流程：

1. 断开集群A，升级新版本
2. 当新版本完全启动后，接入新版本，同时下掉集群 B
3. 断开集群 B，升级新版本
4. 当新版本完全启动后，接入新版本



## 红黑发布

![红黑发布](https://my-photos-1.oss-cn-hangzhou.aliyuncs.com/markdown//%E8%BF%90%E7%BB%B4/20230725/%E7%BA%A2%E9%BB%91%E5%8F%91%E5%B8%83.png)

红黑发布利用云服务的弹性伸缩，发布流程：

1. 启动一个新的集群 B，完成后连接到集群 B
2. 断开集群 A，并释放集群 A 的所有资源





## 灰度发布

![灰度发布](https://my-photos-1.oss-cn-hangzhou.aliyuncs.com/markdown//%E8%BF%90%E7%BB%B4/20230725/%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83.png)

发布流程：

1. 启动新版本集群 B，将部分流量接入集群 B
2. 如果新版本可以使用，继续加大集群 B 的流量
3. 最终将全部流量切换到集群 B，并断开集群 A

可能的挑战：

1. 新旧版本系统的 SQL 语句可能不一致，需要考虑兼容性
2. 新旧版本无法协同作业，此时可以改用红黑发布
3. 如果使用随机访问的负载均衡策略，可能出现同一个用户在新旧版本切换，大概率会出现 Bug
4. 注意要进行链路追踪，统计新版本的请求数据